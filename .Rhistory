mutate(species = stringr::word(taxa, 1, 2, sep = "_") ) |>
group_by(species) |>
summarise(cats = paste0(unique(RL.cat), collapse = ",")) |>
mutate(RL.cat = case_when(!grepl(",", cats) ~ cats,
grepl("LC", cats) ~ "LC",
grepl("VU", cats) ~ "VU",
grepl("EN", cats) ~ "EN",
grepl("CR", cats) ~ "CR"))
ericatable <- read_csv("E:/UNI/4. DOCTORADO/99. OTROS/8888_Terminados/2024_06_14 EDGE Workshop/materials_workshop/local/files/ericatable.csv") |>
mutate(species = stringr::word(taxa, 1, 2, sep = "_") ) |>
group_by(species) |>
summarise(cats = paste0(unique(RL.cat), collapse = ",")) |>
mutate(RL.cat = case_when(!grepl(",", cats) ~ cats,
grepl("LC", cats) ~ "LC",
grepl("VU", cats) ~ "VU",
grepl("EN", cats) ~ "EN",
grepl("CR", cats) ~ "CR")) |>
select(-cats)
setdiff(tree$tip.label, ericatable$species)
setdiff(ericatable$species, tree$tip.label)
write_csv(ericatable, "datos/Erica_IUCN.csv")
devtools::load_all("E:/UNI/6. SEVILLA/99. OTROS/2025_01_26 EDGEcalc package/EDGEcalc")
calculate_EDGE2(tree, ericatable)
e2 <- calculate_EDGE2(tree, ericatable)
ape::rtree(8)
ape::write.tree(ape::rtree(8), "clipboard")
tEDGE <- ((A:1, B:1), C:2):1,(D:1, E:1):2;
nexus <- ((A:1, B:1), C:2):1,(D:1, E:1):2;
ape::read.treenexus
ape::read.tree(nexus)
nexus <- "((A:1, B:1), C:2):1,(D:1, E:1):2;"
ape::read.tree(nexus)
ape::read.nexus(nexus)
nexus <- "((A:1, B:1):1, C:2):1,(D:1, E:1):2;"
ape::read.nexus(nexus)
nexus <-
ape::read.nexus("((A:1, B:1):1, C:2):1,(D:1, E:1):2;")
nexus <-
ape::read.nexus("((A:1, B:1):1, C:2);")
ape::read.nexus("((t8:0.7419193427,((t7:0.8850358357,(t6:0.5906700136,t5:0.8067287577):0.06347560557):0.8886504532,(t2:0.9963375819,(t4:0.07766615553,t1:0.5686050721):0.9008465526):0.3063812684):0.8976753838):0.1855030598,t3:0.0245057987);")
nexus <-
ape::read.tree(text = "((A:1, B:1):1, C:2):1,(D:1, E:1):2;")
ape::read.tree(text = "((A:1, B:1):1, C:2):1,(D:1, E:1):2;")
ape::read.tree(text = "((A:1, B:1):1, C:2):1,(D:1, E:1):2;") |>
ape::plot()
ape::read.tree(text = "((A:1, B:1):1, C:2):1,(D:1, E:1):2;") |>
ape::plot.phylo()
ape::read.tree(text = "((A:1, B:1):1, C:2):3,(D:1, E:1):2;") |>
ape::plot.phylo()
ape::read.tree(text = "((A:1, B:1):1, C:2):1,(D:1, E:1):3;") |>
ape::plot.phylo()
library(ape)
rtree(2)
tree <- rtree(2)
set.seed(1)
tree <- rtree(2)
plot(tree)
tree$tip.label
tree$tip.label <- c("G", "A")
plot(tree)
tree$edge.length
tree$edge.length <- c(5,5)
plot(tree)
library(phytools)
plot(tree);nodelabels()
plot(tree);nodelabels();tiplabels()
bind.tip(tree, tip.label = "B", edge.length = 1, where = 2, position = 1)
plot(tree);nodelabels();tiplabels()
tree <- bind.tip(tree, tip.label = "B", edge.length = 1, where = 2, position = 1)
plot(tree);nodelabels();tiplabels()
tree <- bind.tip(tree, tip.label = "C", edge.length = 2, where = 5, position = 1)
plot(tree);nodelabels();tiplabels()
tree$tip.label <- c("A", "G")
set.seed(1)
tree <- rtree(2)
tree$tip.label <- c("A", "G")
tree$edge.length <- c(5,5)
tree <- bind.tip(tree, tip.label = "B", edge.length = 1, where = 2, position = 1)
tree <- bind.tip(tree, tip.label = "C", edge.length = 2, where = 5, position = 1)
plot(tree);nodelabels();tiplabels()
set.seed(1)
tree <- rtree(2)
tree$tip.label <- c("A", "G")
tree$edge.length <- c(5,5)
plot(tree);nodelabels();tiplabels()
tree <- bind.tip(tree, tip.label = "B", edge.length = 1, where = 1, position = 1)
plot(tree);nodelabels();tiplabels()
tree <- bind.tip(tree, tip.label = "C", edge.length = 2, where = 5, position = 1)
plot(tree);nodelabels();tiplabels()
tree <- bind.tip(tree, tip.label = "D", edge.length = 3, where = 6, position = 1)
plot(tree);nodelabels();tiplabels()
tree <- bind.tip(tree, tip.label = "E", edge.length = 1, where = 4, position = 1)
plot(tree);nodelabels();tiplabels()
tree <- bind.tip(tree, tip.label = "F", edge.length =.5, where = 6, position =.5)
plot(tree);nodelabels();tiplabels()
rotate(tree)
plot(tree);nodelabels();tiplabels()
tree <- rotate(tree, 8)
plot(tree);nodelabels();tiplabels()
)
)
)
set.seed(1)
tree <- rtree(2)
tree$tip.label <- c("G", "A")
tree$edge.length <- c(5,5)
plot(tree);nodelabels();tiplabels()
tree <- bind.tip(tree, tip.label = "F", edge.length =.5, where = 1, position =.5)
plot(tree);nodelabels();tiplabels()
tree <- bind.tip(tree, tip.label = "E", edge.length = 3, where = 3, position = 3)
plot(tree);nodelabels();tiplabels()
tree <- bind.tip(tree, tip.label = "D", edge.length = 1, where = 3, position = 1)
plot(tree);nodelabels();tiplabels()
set.seed(1)
tree <- rtree(2)
tree$tip.label <- c("G", "E")
tree$edge.length <- c(5,5)
tree <- bind.tip(tree, tip.label = "F", edge.length =.5, where = 1, position =.5)
tree <- bind.tip(tree, tip.label = "E", edge.length = 3, where = 3, position = 3)
set.seed(1)
tree <- rtree(2)
tree$tip.label <- c("G", "E")
tree$edge.length <- c(5,5)
plot(tree);nodelabels();tiplabels()
tree <- bind.tip(tree, tip.label = "F", edge.length =.5, where = 1, position =.5)
plot(tree);nodelabels();tiplabels()
tree <- bind.tip(tree, tip.label = "D", edge.length = 3, where = 3, position = 3)
plot(tree);nodelabels();tiplabels()
set.seed(1)
tree <- rtree(2)
tree$tip.label <- c("G", "E")
tree$edge.length <- c(5,5)
tree <- bind.tip(tree, tip.label = "F", edge.length =.5, where = 1, position =.5)
tree <- bind.tip(tree, tip.label = "D", edge.length = 3, where = 3, position = 3)
plot(tree);nodelabels();tiplabels()
set.seed(1)
tree <- rtree(2)
tree$tip.label <- c("G", "E")
tree$edge.length <- c(5,5)
tree <- bind.tip(tree, tip.label = "F", edge.length =.5, where = 1, position =.5)
plot(tree);nodelabels();tiplabels()
tree <- bind.tip(tree, tip.label = "D", edge.length = 1, where = 3, position = 1)
plot(tree);nodelabels();tiplabels()
tree <- bind.tip(tree, tip.label = "C", edge.length = 3, where = 6, position = 1)
plot(tree);nodelabels();tiplabels()
set.seed(1)
tree <- rtree(2)
tree$tip.label <- c("G", "E")
tree$edge.length <- c(5,5)
tree <- bind.tip(tree, tip.label = "F", edge.length =.5, where = 1, position =.5)
tree <- bind.tip(tree, tip.label = "D", edge.length = 1, where = 3, position = 1)
plot(tree);nodelabels();tiplabels()
tree <- bind.tip(tree, tip.label = "C", edge.length = 3, where = 6, position = 2)
plot(tree);nodelabels();tiplabels()
set.seed(1)
tree <- rtree(2)
tree$tip.label <- c("G", "E")
tree$edge.length <- c(5,5)
tree <- bind.tip(tree, tip.label = "F", edge.length =.5, where = 1, position =.5)
tree <- bind.tip(tree, tip.label = "D", edge.length = 1, where = 3, position = 1)
plot(tree);nodelabels();tiplabels()
tree <- bind.tip(tree, tip.label = "C", edge.length = 3, where = 7, position = 2)
plot(tree);nodelabels();tiplabels()
tree <- bind.tip(tree, tip.label = "B", edge.length = 2, where = 5, position = 2)
plot(tree);nodelabels();tiplabels()
tree <- bind.tip(tree, tip.label = "A", edge.length = 1, where = 6, position = 1)
plot(tree);nodelabels();tiplabels()
plot(tree)
write.tree(tree, "datos/EDGEtree.tre")
EDGEcalc::calculate_EDGE1(tree, table = data.frame("species" = tree$tip.label, "RL.cat" = "DD"))
plot(tree)
EDGEcalc::calculate_EDGE1(tree, table = data.frame("species" = tree$tip.label, "RL.cat" = "DEW"))
EDGEcalc::calculate_EDGE1(tree, table = data.frame("species" = tree$tip.label, "RL.cat" = ""))
EDGEcalc::calculate_EDGE1(tree, table = data.frame("species" = tree$tip.label, "RL.cat" = "DD "))
EDGEcalc::calculate_EDGE1(tree, table = data.frame("species" = tree$tip.label, "RL.cat" = "DD"))
library(EDGEcalc)
EDGEtab <- data.frame("species" = tree$tip.label, "RL.cat" = "DD")
calculate_EDGE2(tree, EDGEtab)
calculate_EDGE2(tree, EDGEtab, sort.list = T)
calculate_EDGE2(tree, EDGEtab, sort.list = T)
EDGElist <- calculate_EDGE2_multiple(tree, EDGEtab, sort.list = T, n.iter = 30, parallelize = T)
EDGElist
library(tidyverse)
bind_rows(EDGElist)
bind_rows(EDGElist) |>
group_by(species) |>
summarise(EDGEmean = mean(EDGE))
bind_rows(EDGElist) |>
group_by(species) |>
summarise(EDGEmean = mean(EDGE),
EDmean   = mean(ED),
pextmean = mean(pext),
RLcat = paste0(unique(RL.cat)))
bind_rows(EDGElist) |>
group_by(species) |>
summarise(RLcat = paste0(unique(RL.cat)),
pextmean = mean(pext),
EDmean   = mean(ED),
EDGEmean = mean(EDGE))
set.seed(1)
t2 <- rtree(25)
library(ape)
library(phytools)
t2 <- rtree(25)
plot(t2)
t2 <- force.ultrametric(rtree(25))
t2
set.seed(1)
t2 <- force.ultrametric(rtree(25))
plot(t2)
plot(t2)
plot(t2, show.tip.label = F)
set.seed(1)
t2 <- force.ultrametric(rtree(50))
plot(t2, show.tip.label = F)
t2 <- force.ultrametric(rtree(50), method = "extend")
plot(t2, show.tip.label = F)
t2 <- force.ultrametric(rtree(50))
plot(t2, show.tip.label = F)
set.seed(1)
t2 <- force.ultrametric(rtree(50))
plot(t2, show.tip.label = F)
t2 <- force.ultrametric(rtree(50), method = "extend")
plot(t2, show.tip.label = F)
tiplabels()
x11()
tiplabels()
plot(t2, show.tip.label = F)
tiplabels()
tiplabels(tip = c(10, 11, 42), pch = 16, col = "red")
plot(t2, show.tip.label = F)
tiplabels(tip = c(10, 11, 42), pch = 16, col = "red")
tips <- c(10, 11, 42)
tiplabels(tip = tips, pch = 16, col = "red")
tips <- c(10, 11, 42)
plot(t2, show.tip.label = F)
tiplabels(tip = tips, pch = 16, col = "red")
nodelabels()
nodes <- c(70, 71, 72, 73, 83, 88, 94, 95, 52, 53, 55, 56, 59, 60, 63, 64)
col <- rep("black", times = nrow(t2$edge))
col
col[t2$e[,2] %in% c(tips, nodes)] <- "red"
plot(t2, show.tip.label = F, edge.color = col)
col
col[t2$edge[,2] %in% c(tips, nodes)]
col[t2$edge[,2] %in% c(tips, nodes)] <- "red"
nodelabels()
plot(t2, show.tip.label = F, edge.color = col)
tiplabels(tip = tips, pch = 16, col = "red")
t2 <- randtip::mammals
plot(t2)
plot(t2, show.tip.label = = F)
plot(t2, show.tip.label = F)
nodelabels()
t2[t2$edge[,1] == 5917]
t2$edge[t2$edge[,1] == 5917,]
nd <- 11461
t3 <- extract.clade(t2, nd)
plot(t3, show.tip.label = F)
nodelabels()
plot(t3, show.tip.label = F)
nodelabels()
nd <- 579
t3 <- extract.clade(t3, nd)
plot(t3, show.tip.label = F)
nd <- 11461
t3 <- extract.clade(t2, nd)
nd <- 579
t4 <- extract.clade(t3, nd)
plot(t3, show.tip.label = F)
t3 <- extract.clade(t2, nd)
plot(t4, show.tip.label = F)
tiplabels()
plot(t4, show.tip.label = F)
plot(t3, show.tip.label = F)
nodelabels()
nd <- 501
t4 <- extract.clade(t3, nd)
plot(t4, show.tip.label = F)
tiplabels()
tiplabels(tip = c(1, 41), pch = 16, col = "red")
plot(t4, show.tip.label = F)
tiplabels(tip = c(1, 41), pch = 16, col = "red")
nodelabels()
phytools::node.paths(t4, 41)
phytools::node.paths(t4, 1)
phytools::node.paths(t4, 82)
phytools::node.paths(t4, 80)
a <- phytools::node.paths(t4, 80)
a[[41]]
nds <- phytools::node.paths(t4, 80)[[41]]
col <- rep("black", times = nrow(t4$edge))
col[t4$edge[,2] %in% c(nds, 1, 41)] <- "red"
plot(t4, show.tip.label = F, edge.color = col)
png("../ppt EDGE/imágenes/EDtree.png")
plot(t4, show.tip.label = F, edge.color = col)
tiplabels(tip = c(1, 41), pch = 16, col = "red")
dev.off()
plot(t3)
x11()
plot(t3)
plot(t3, show.tip.label = F)
nodelabels()
nd <- 502
t4 <- extract.clade(t3, nd)
plot(t4, show.tip.label = F, edge.color = col)
tiplabels()
nodelabels()
nds <- phytools::node.paths(t4, 79)[[40]]
col <- rep("black", times = nrow(t4$edge))
col[t4$edge[,2] %in% c(nds, 40, 78)] <- "red"
plot(t4, show.tip.label = F, edge.color = col)
plot(t4, show.tip.label = F, edge.color = col, edge.width = 2)
tiplabels(tip = c(1, 41), pch = 16, col = "red")
png("../ppt EDGE/imágenes/EDtree.png")
plot(t4, show.tip.label = F, edge.color = col, edge.width = 2)
tiplabels(tip = c(1, 41), pch = 16, col = "red")
dev.off()
png("../ppt EDGE/imágenes/EDtree.png")
plot(t4, show.tip.label = F, edge.color = col, edge.width = 2)
tiplabels(tip = c(40, 78), pch = 16, col = "red")
dev.off()
col[t4$edge[,2] %in% c(nds, 40, 78)] <- 2
png("../ppt EDGE/imágenes/EDtree.png")
plot(t4, show.tip.label = F, edge.color = col, edge.width = col)
tiplabels(tip = c(40, 78), pch = 16, col = "red")
dev.off()
col
col <- rep(1, times = nrow(t4$edge))
col[t4$edge[,2] %in% c(nds, 40, 78)] <- 2
png("../ppt EDGE/imágenes/EDtree.png")
plot(t4, show.tip.label = F, edge.color = col, edge.width = col)
tiplabels(tip = c(40, 78), pch = 16, col = "red")
dev.off()
options(bg="grey")
plot(t4, show.tip.label = F, edge.color = col, edge.width = col)
png("../ppt EDGE/imágenes/EDtree.png")
options(bg="grey")
plot(t4, show.tip.label = F, edge.color = col, edge.width = col)
tiplabels(tip = c(40, 78), pch = 16, col = "red")
dev.off()
par(bg="grey")
plot(t4, show.tip.label = F, edge.color = col, edge.width = col)
png("../ppt EDGE/imágenes/EDtree.png")
par(bg="grey")
plot(t4, show.tip.label = F, edge.color = col, edge.width = col)
tiplabels(tip = c(40, 78), pch = 16, col = "red")
dev.off()
png("../ppt EDGE/imágenes/EDtree.png")
par(bg="transparent")
plot(t4, show.tip.label = F, edge.color = col, edge.width = col)
tiplabels(tip = c(40, 78), pch = 16, col = "red")
dev.off()
erica.tree <- read.tree("datos/Ericatree.tre")
erica.tree <- read.tree("datos/EDGEtree.tre")
erica.tree <- read.tree("datos/Erica_tree.tre")
erica.iucn <- read_csv("datos/Erica_IUCN.csv")
library(tidyverse)
library(EDGEcalc)
erica.tree <- read.tree("datos/Erica_tree.tre")
erica.iucn <- read_csv("datos/Erica_IUCN.csv")
plot(erica.tree)
head(erica.iucn)
glimpse(erica.iucn)
head
head(erica.iucn)
calculate_EDGE1(tree = erica.tree, table = erica.iucn)
tree = erica.tree
devtools::load_all()
library(EDGEcalc)
calculate_EDGE1(tree = erica.tree, table = erica.iucn)
devtools::load_all("E:/UNI/6. SEVILLA/99. OTROS/2025_01_26 EDGEcalc package/EDGEcalc")
calculate_EDGE1(tree = erica.tree, table = erica.iucn)
devtools::install_github("iramosgutierrez/EDGEcalc")
library(tidyverse)
library(EDGEcalc)
erica.tree <- read.tree("datos/Erica_tree.tre")
library(ape)
erica.tree <- read.tree("datos/Erica_tree.tre")
erica.iucn <- read_csv("datos/Erica_IUCN.csv")
plot(erica.tree)
plot(erica.tree, cex = 0.5)
head(erica.iucn)
calculate_EDGE1(tree = erica.tree, table = erica.iucn)
EDGElist <- calculate_EDGE1(tree = erica.tree, table = erica.iucn)
View(EDGElist)
View(EDGElist)
nrow(EDGElist[!is.na(EDGElist$EDGE)])
nrow(EDGElist[!is.na(EDGElist$EDGE),])
nrow(EDGElist[is.na(EDGElist$EDGE),])
x11()
print(EDGElist, max = 10)
print(EDGElist, n.print = 10)
View(EDGElist)
EDGElist <- calculate_EDGE1(tree = erica.tree, table = erica.iucn,
sort.list = T)
EDGElist
print(EDGElist, n.print = 10)
?print
print(EDGElist, max = 10)
print(EDGElist, max = 100)
print(EDGElist, max = 50)
print(EDGElist)
EDGElist <- calculate_EDGE1(tree = erica.tree, table = erica.iucn,
sort.list = F)
print(EDGElist)
EDGElist <- calculate_EDGE1(tree = erica.tree, table = erica.iucn,
sort.list = T)
print(EDGElist)
print(EDGElist, max = Inf)
print(EDGElist, max = 9999999)
set.seed(1)
tree <- rtree(2)
tree$tip.label <- c("G", "E")
tree$edge.length <- c(5,5)
tree <- bind.tip(tree, tip.label = "F", edge.length =.5, where = 1, position =.5)
tree <- bind.tip(tree, tip.label = "D", edge.length = 1, where = 3, position = 1)
tree <- bind.tip(tree, tip.label = "C", edge.length = 3, where = 7, position = 2)
tree <- bind.tip(tree, tip.label = "B", edge.length = 2, where = 5, position = 2)
library(phytools)
library(phytools)
set.seed(1)
tree <- rtree(2)
tree$tip.label <- c("G", "E")
tree$edge.length <- c(5,5)
tree <- bind.tip(tree, tip.label = "F", edge.length =.5, where = 1, position =.5)
tree <- bind.tip(tree, tip.label = "D", edge.length = 1, where = 3, position = 1)
tree <- bind.tip(tree, tip.label = "C", edge.length = 3, where = 7, position = 2)
tree <- bind.tip(tree, tip.label = "B", edge.length = 2, where = 5, position = 2)
tree <- bind.tip(tree, tip.label = "A", edge.length = 1, where = 6, position = 1)
plot(tree)
nodelabels()
tree <- bind.tip(tree, tip.label = "C'", edge.length = 2, where = 11, position = 1)
plot(tree)
write.tree(tree, "datos/EDGEtree_mod.tre")
tree <- read.tree( "datos/EDGEtree.tre")
plot(tree)
tree <- read.tree( "datos/EDGEtree_mod.tre")
tree <- read.tree("datos/EDGEtree_mod.tre")
"datos/EDGEtree_mod.tre"
read.tree("datos/EDGEtree_mod.tre")
read.tree("datos/EDGEtree_mod.tre")
tree <- read.tree("datos/EDGEtree_mod.tre")
plot(tree)
plot(tree, edge.width = 2)
plot(tree, edge.width = 2, cex = 2)
dev.off()
png("../ppt EDGE/imágenes/EDtree.png")
plot(tree, edge.width = 2, cex = 2)
dev.off()
tree$tip.label
calculate_EDGE1(tree,
table = data.frame("species" = tree$tip.label,
"RL.cat" = c("LC", "LC", "CR",
"EN", "VU", "VU",
"NT", "LC")))
library(tidyverse)
library(EDGEcalc)
library(ape)
devtools::install_github("iramosgutierrez/EDGEcalc")
# Antirrhineae ####
table <- read_csv("E:/UNI/6. SEVILLA/99. OTROS/2025_03_26 II Congreso SEBOT/Taller SpatPhylo/antirrhineae_mfm/EDGE_Antirrhineae.xlsx")
# Antirrhineae ####
table <- openxlsx::read.xlsx("E:/UNI/6. SEVILLA/99. OTROS/2025_03_26 II Congreso SEBOT/Taller SpatPhylo/antirrhineae_mfm/EDGE_Antirrhineae.xlsx")
View(table)
# Antirrhineae ####
table_raw <- openxlsx::read.xlsx("E:/UNI/6. SEVILLA/99. OTROS/2025_03_26 II Congreso SEBOT/Taller SpatPhylo/antirrhineae_mfm/EDGE_Antirrhineae.xlsx")
table <- table_raw |>
select(species = Species,
RL.cat = IUCN)
tree <- read.tree("E:/UNI/6. SEVILLA/99. OTROS/2025_03_26 II Congreso SEBOT/Taller SpatPhylo/antirrhineae_mfm/Antirrhineae_all.tre")
setdiff(table$species, tree$tip.label)
View(data.frame("sp" = tree$tip.label))
tree$tip.label[tree$tip.label == "Pseudomisopates_rivas_martinezii"] <- "Pseudomisopates_rivas-martinezii"
tree$tip.label[tree$tip.label == "Antirrhinum_braun_blanquetii"] <- "Antirrhinum_braun-blanquetii"
setdiff(table$species, tree$tip.label)
setdiff(table$species, tree$tip.label)
table_NE <- data.frame("species" = tree$tip.label[!tree$tip.label %in% table$species])
View(table_NE)
106+198
table_NE <- data.frame("species" = tree$tip.label[!tree$tip.label %in% table$species], "RL.cat" = "NE")
bind_rows(table, table_NE)
table <- bind_rows(table, table_NE)
EDGEcalc::calculate_EDGE1(tree, table)
edgelist <- EDGEcalc::calculate_EDGE1(tree, table, T)
View(edgelist)
View(table_raw)
# Antirrhineae ####
table_raw <- openxlsx::read.xlsx("E:/UNI/6. SEVILLA/99. OTROS/2025_03_26 II Congreso SEBOT/Taller SpatPhylo/antirrhineae_mfm/EDGE_Antirrhineae.xlsx")
# Antirrhineae ####
table_raw <- openxlsx::read.xlsx("E:/UNI/6. SEVILLA/99. OTROS/2025_03_26 II Congreso SEBOT/Taller SpatPhylo/antirrhineae_mfm/EDGE_Antirrhineae.xlsx")
table_Ib <- table_raw |>
select(species = Species,
RL.cat = IUCN)
tree <- read.tree("E:/UNI/6. SEVILLA/99. OTROS/2025_03_26 II Congreso SEBOT/Taller SpatPhylo/antirrhineae_mfm/Antirrhineae_all.tre")
tree$tip.label[tree$tip.label == "Pseudomisopates_rivas_martinezii"] <- "Pseudomisopates_rivas-martinezii"
tree$tip.label[tree$tip.label == "Antirrhinum_braun_blanquetii"] <- "Antirrhinum_braun-blanquetii"
setdiff(table_Ib$species, tree$tip.label)
table_NE <- data.frame("species" = tree$tip.label[!tree$tip.label %in% table$species], "RL.cat" = "NE")
table_NE <- data.frame("species" = tree$tip.label[!tree$tip.label %in% table$species], "RL.cat" = "NE")
table_NE <- data.frame("species" = tree$tip.label[!tree$tip.label %in% table_Ib$species], "RL.cat" = "NE")
table <- bind_rows(table, table_NE)
table <- bind_rows(table_Ib, table_NE)
edgelist <- EDGEcalc::calculate_EDGE1(tree, table, T)
edgelist_IB <- EDGEcalc::calculate_EDGE1(keep.tip(tree, table_Ib$species), table_Ib, T)
View(edgelist_IB)
caper::ed.calc(tree)
EDcaper <- caper::ed.calc(tree)[[1]]
View(EDcaper)
EDpican <- picante::evol.distinct(tree, type = "fair.proportion", scale = FALSE, use.branch.lengths = TRUE)
View(EDpican)
plot(tree)
